name: Test Suite

on: [push]

jobs:
  test:
    runs-on: ubuntu-latest

    container:
      image: ghcr.io/rvernica/scidb:19.11-xenial
      volumes:
        - /dev/shm
      ports:
        - 8080:8080
        - 8083:8083

    strategy:
      matrix:
        python-version: [3.6, 3.7, 3.8, 3.9]

    steps:
      - name: Wait for SciDB to start
        run: while ! curl http://localhost:8080/version; do sleep 5; done

      - name: Check out repository
        uses: actions/checkout@v2

      - name: Set-up Docker container
        run: |
          pwd
          ls
